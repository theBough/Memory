Public Class Form1
    Dim grid(6, 6) As PictureBox
    Dim di As New IO.DirectoryInfo(CurDir() & "\pics")
    Dim fileArray As IO.FileInfo() = di.GetFiles

    Dim generator As New Random
    Dim numbersUsed(36) As Integer
    Dim inderOfNumbersUsed As Integer = 0

    Dim clicks As Integer = 0
    Dim counter As Integer = 0

    Private Sub btnStart_Click(sender As Object, e As EventArgs) Handles btnStart.Click
        createGrid()
    End Sub

    Sub createGrid()
        For x = 0 To 5
            For y = 0 To 5
                grid(x, y) = New PictureBox
                With grid(x, y)
                    .Width = 60
                    .Height = 60
                    .BackColor = Color.Red
                    .Top = x * 65 + 100
                    .Left = y * 65 + 100
                    'Pick a random number 1 and 18
                    'check to see if that picture is TAKEN
                    'if TRUE I want to pick a new random number
                    'grab the image at that index
                    'replace the name with something like TAKEN
                    .Tag = fileArray(getRandomPic()).FullName
                    'fileArray(tempNumber).FullName = "taken"
                    .SizeMode = PictureBoxSizeMode.StretchImage
                End With
                Me.Controls.Add(grid(x, y))
                AddHandler grid(x, y).Click, AddressOf buttonClickEvents
            Next
        Next
    End Sub
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        For i = 0 To numbersUsed.Length - 1
            numbersUsed(i) = -1
        Next
    End Sub
    Function getRandomPic()
        Dim tempNum As Integer = generator.Next(0, 36)
        For i = 0 To numbersUsed.Length - 1
            If tempNum = numbersUsed(i) Then
                tempNum = generator.Next(0, 36)
                i = -1
            End If
        Next
        numbersUsed(inderOfNumbersUsed) = tempNum
        inderOfNumbersUsed += 1
        Return tempNum
    End Function
    Sub buttonClickEvents(sender As Object, e As EventArgs)
        sender.Image = Image.FromFile(sender.Tag)
        Label1.Text = getRidOfCopy(sender.tag)
        clicks += 1
        If clicks = 2 Then
            clicks = 0
            turnOnOffButtons(False)
            Timer1.Start()
        End If
    End Sub

    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick
        counter += 1
        If counter > 10 Then
            Timer1.Stop()
            turnOnOffButtons(True)
            counter = 0
            For x = 0 To 5
                For y = 0 To 5
                    grid(x, y).Image = Nothing
                Next
            Next
        End If
    End Sub

    Sub turnOnOffButtons(isOn As Boolean)
        For x = 0 To 5
            For y = 0 To 5
                grid(x, y).Enabled = isOn
            Next
        Next
    End Sub

    Function getRidOfCopy(picName As String)
        Dim tempword As String
        If picName.Length > 7 Then
            tempword = picName.Substring(picName.Length - 8, 4)
        Else
            Return picName
        End If

        If tempWord = "Copy" Then
            picName = picName.Substring(0, picName.Length - 11) & ".png"
            Return picName
        End If
        Return picName
    End Function
End Class
